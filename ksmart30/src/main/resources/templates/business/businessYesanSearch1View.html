<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="layout/main">

<th:block layout:fragment="customHead">
	<meta charset="UTF-8">
	<title>2.2.4 승인된 승인 사업성검토 검색 List</title>
	<th:block th:include="layout/customHead"></th:block>

	<script src="http://code.jquery.com/jquery-1.9.1.js"></script>


	<script>
	//사업성검토 검색1
		$(document).ready(()=>{
			$('#searchList').click(()=>{
				console.log('눌려라요오오오~');
				const DEPT_NM = $('#DEPT_NM').val();
				console.log(DEPT_NM+'DEPT_NM 받아라요~');
				$.ajax({
					url : '/businessYesanSearchView',
					type : 'GET',
					data : {DEPT_NM:DEPT_NM},
					success : (list)=>{
					 	console.log(list+'<--list');
						let tr = '';					
						$(list).each((index,item)=>{
							const index1 = index+1;
							$('#list').empty();
							tr += '<tr>';
							tr += '<td>'+index1+'</td>';
							tr += '<td>'+item.pjt_NM+'</td>';
							tr += '<td>'+item.pjt_END_S+'</td>';
							tr += '<td>'+item.pjt_END_E+'</td>';
							tr += '<td>'+item.pjt_END_G+'</td>';
							tr += '<td>'+item.pjt_END_T+'</td>';
							tr += '<td>'+item.addr+'</td>';
							tr += '<td>'+item.pm_EMP_NM+'</td>';
							tr += '<td>'+item.emp_NM+'</td>';
							tr += '<td>'+item.pd_EMP_NM+'</td>';
							tr += '<td>'+item.market_NM+'</td>';				
							tr += '<td>'+item.dept_NM+'</td>';
							tr += '<td>'+item.cust_GBN_NM+'</td>';
							tr += '<td>'+item.cust_NM+'</td>';
							tr += '<td>'+item.biz_GBN+'</td>';
							tr += '<td>'+item.forecast_AMT+'</td>';
							tr += '<td>'+item.end_EXP_DATE+'</td>';
							tr += '<td>'+item.end_GBN+'</td>';
							tr += '<td>'+item.contract_AMT+'</td>';
							tr += '<td>'+item.area_P+'</td>';
							tr += '<td>'+item.yarea_P+'</td>';
							tr += '<td>'+item.build_TYPE_NM+'</td>';
							tr += '<td>'+item.product+'</td>';
							tr += '<td></td>';
							tr += '</tr>';
						});
						$('#list').append(tr);
					}
				});
			});
			$('#btnBusinessSearch').click(()=>{
				console.log('눌려라요~~');
				const PJT_CD = $('#PJT_CD').val();
				const businessSelect = $('#businessSelect').val();
				if(businessSelect == '프로젝트코드'){
					$.ajax({
						url : '/businessPjtCd',
	 					type : 'GET',
	 					data : {PJT_CD:PJT_CD},
						success:(businessList)=>{
							console.log(businessList);
							let tr='';
							$(businessList).each((index,item)=>{
								$('#businessList').empty();
								tr += '<tr>';
								tr += '<td>'+item.pjt_CD+'</td>';
								tr += '<td>'+item.pjt_NM+'</td>';
								tr += '</tr>';
							});
							$('#businessList').append(tr);
						}
					});
				}else if(businessSelect == '프로젝트명'){
					$.ajax({
						url : '/businessYesanOutputView',
	 					type : 'GET',
	 					data : {PJT_NM:PJT_CD},
						success:(businessList)=>{
							console.log(businessList);
							let tr='';
							$(businessList).each((index,item)=>{
								$('#businessList').empty();
								tr += '<tr>';
								tr += '<td>'+item.pjt_CD+'</td>';
								tr += '<td>'+item.pjt_NM+'</td>';
								tr += '</tr>';
							});
							$('#businessList').append(tr);
						}
					});
				}
				
			});
			$('#businessList').delegate('tr', 'dblclick', function(){
				let tr = $(this);
				let td = tr.children();
				$('#pjCode').val(td.eq(0).text());
				$('#pjName').val(td.eq(1).text());
				$('#PJT_CD').val('');
				$('#accountModal').click();
			});
		});
	</script>
</th:block>
<th:block layout:fragment="customBody">


	<!-- 검색 폼 -->
	<div class="col-md-9 col-xs-12" style="color:black;">
		<div class="page-title">
			<div class="title_left">
				<h2><b>사업성검토 검색1</b></h2>
				<h5><fontcolor="gray"><b>1.사업성검토 관리&nbsp;>&nbsp;&nbsp;1.2사업성검토예산 관리&nbsp;>&nbsp;&nbsp;1.2.3사업성검토 검색</b></font></h5>	
			</div>
		</div>
	</div>
	<div class="x_content" style="text-align: right">
		<div class="btn-group" >
			<button class="btn btn-default" type="reset" id="searchList">조회</button>
			<button class="btn btn-default" type="button">입력</button>
			<button class="btn btn-default" type="button">수정</button>
			<button class="btn btn-default" type="button">삭제</button>
			<button class="btn btn-default" type="button">저장</button>
			<button class="btn btn-default" type="button">출력</button>
		</div>
	</div>
	<div class="x_panel" style="color:black;">
	<h4>검색 조건</h4>
	<table class="table" border = "1">
		<tr>
			<td colspan="3">
				⊙ 부　서 :
				<select id="DEPT_NM">
					<option value="">전　　　사</option>
					<th:block th:each="d : ${searchDept}">
						<option>[[${d.DEPT_NM}]]</option>
					</th:block>
				</select>
			</td>
		</tr>
		<tr>
			<td>
			⊙ 코드명 :
					<input type="text" name="test" id="pjCode" size="10">
						<button type="button" data-toggle="modal" data-target=".bs-example-modal-lg1"><i class="fa fa-search"></i></button>
					<input type="text" name="test" id="pjName" size="40">
					<div class="modal fade bs-example-modal-lg1" tabindex="-1" role="dialog" aria-hidden="true">
						<div class="modal-dialog modal-lg">
							<div class="modal-content">
								<form class="form-horizontal">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal" id="accountModal"><span aria-hidden="true">×</span>
										</button>
										<h4 class="modal-title" id="myModalLabel"><b>프로젝트코드조회</b></h4><br>
										<!-- <div class="table-responsive"> -->
											<table class="table table-bordered">
												<tbody>
													<tr>
														<td><label class="control-label">검색항목</label></td>
														<td>
															<select class="form-control" style="width: 40%" id="businessSelect">
																<option>프로젝트코드</option>
																<option>프로젝트명</option>
															</select>
														</td>
													</tr>
													<tr>
														<td><label class="control-label">검색조건</label></td>
														<td>
															<input type="text" id="PJT_CD">
															<button id="btnBusinessSearch" type="button"><i class="fa fa-search"></i></button>																	
														</td>
													</tr>
												</tbody>																	
											</table>
										<!-- </div> -->
									</div>
									<div class="modal-body">
										<div class="table-responsive" style="overflow: auto; height: 400px;">
										<table class="table table-striped table-bordered table-hover jambo_table">
											<thead>
												<tr>
													<th>코드</th>
													<th>프로젝트명</th>
												</tr>
											</thead>
											<tbody id="businessList">
												<tr>
													<td></td>
													<td></td>
												</tr>
												<tr>
													<td></td>
													<td></td>
												</tr>
												<tr>
													<td></td>
													<td></td>
												</tr>
												<tr>
													<td></td>
													<td></td>
												</tr>
											</tbody>																	
										</table>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
			</td>
			<td>
			⊙ 수주구분　:
					<select>
						<option value=""></option>
						<option value="1">발주의뢰</option>
						<option value="2">저가심의</option>
						<option value="3">적격심사</option>
						<option value="1">현상설계</option>
						<option value="2">지명현상</option>
						<option value="3">TK</option>
						<option value="3">기술제안</option>
					</select>
			</td>
			<td>		
			⊙ 종료구분　　:
				<select>
					<option value=""></option>
					<option value="1">진행</option>
					<option value="2">무산</option>
					<option value="3">계약</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>
				⊙ 지　번 :	
				<input type="text" name="" size="60">
			</td>
			<td>
			⊙ 건축물용도 :
				<select>
					<option value=""></option>
					<option value="1">단독주택</option>
					<option value="2">공동주택</option>
					<option value="3">제1종 근린생황시설</option>
					<option value="4">제2종 근린생황시설</option>
					<option value="5">문화 및 잡화시설</option>
					<option value="6">판매시설</option>
					<option value="7">잡화시설</option>
				</select>
			</td>
			<td>
			⊙ 추정계약금액 :
				<input type="text" name="test">
				<input type="text" name="test">
			</td>
		</tr>
		<tr>
			<td>
				⊙ 발주처 :
				<input type="text" name="test" size="10">
				<button type="button" data-toggle="modal" data-target=".bs-example-modal-lg1"><i class="fa fa-search"></i></button>
				<input type="text" name="test" size="40">
			</td>
			<td>
			⊙ 발주처구분 :
				<select>
					<option value=""></option>
					<option value="1">건설사</option>
					<option value="2">시행사</option>
					<option value="3">공사/공단</option>
					<option value="3">정부기관</option>
					<option value="1">건축설계사무소</option>
					<option value="2">외주협력업체</option>
					<option value="3">조합(재개발,재건축)</option>
				</select>
			</td>
			<td>
			⊙ 업무범위/수준 :
				<select>
					<option value=""></option>
					<option value="1">A1</option>
					<option value="2">A2</option>
					<option value="3">A3</option>
					<option value="2">A4</option>
					<option value="3">A5</option>
				</select>
			</td>
		</tr>
	</table>
	</div>
	<div class="x_panel"  style="color:black;">
		<div class="x_content">
			<div class="table-responsive">
				<div style="overflow:scroll; width:2600px; height:600px; padding:10px; background-color:;">
				<table class="table table-striped jambo_table bulk_action" border="1">
					<thead>
						<tr class="headings" >
							<td class="column-title" style="width:50px;">NO</td>
							<td class="column-title" style="width:300px;">프로젝트명</td>
							<td class="column-title" style="width:50px;">당선</td>
							<td class="column-title" style="width:50px;">탈락</td>
							<td class="column-title" style="width:50px;">무산</td>
							<td class="column-title" style="width:50px;">실시</td>
							<td class="column-title" style="width:200px;">위치/지번</td>
							<td class="column-title" style="width:100px;">PM</td>
							<td class="column-title" style="width:100px;">관리임원</td>
							<td class="column-title" style="width:100px;">PD</td>
							<td class="column-title" style="width:100px;">수주책임자</td>
							<td class="column-title" style="width:150px;">부서</td>
							<td class="column-title" style="width:150px;">발주처구분</td>
							<td class="column-title" style="width:200px;">발주처</td>
							<td class="column-title" style="width:100px;">수주구분</td>
							<td class="column-title" style="width:100px;">추정계약금액</td>
							<td class="column-title" style="width:100px;">작품제출일</td>
							<td class="column-title" style="width:100px;">종료구분</td>
							<td class="column-title" style="width:100px;">계약금액</td>
							<td class="column-title" style="width:100px;">대지(평)</td>
							<td class="column-title" style="width:100px;">연면적(평)</td>
							<td class="column-title" style="width:100px;">건축물용도</td>
							<td class="column-title" style="width:100px;">납품성과물</td>
							<td class="column-title" style="width:100px;">결정서입력자</td>
						</tr>
					</thead>
					<tbody id="list">
					</tbody>
				</table>
				</div>
				<!-- 결과 리스트 끝 -->
			</div>
		</div>
	</div>
</th:block>
<th:block layout:fragment="customJquery">
	<th:block th:include="layout/customJquery"></th:block>
</th:block>
</html>